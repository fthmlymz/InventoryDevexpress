@page "/product/product-and-assigned"
@using InventoryManagement.Frontend.DTOs.Company
@using InventoryManagement.Frontend.DTOs.Product


@inherits ComponentBase




@if (_authorizationService.HasPermission("res:product", "scopes:read"))
{
    @if (productAndAssignedModel != null && productAndAssignedModel.data != null)
    {
        <RadzenDataGrid @ref="productGrid"
                        @bind-Value=@selectedProductAndAssignedProduct
                        AllowFiltering="true"
                        AllowColumnResize="true"
                        AllowSorting="true"
                        Data="@productAndAssignedModel?.data"
                        TItem="GetProductWithPaginationDto"
                        CellContextMenu="@OnCellContextMenu"
                        SelectionMode="DataGridSelectionMode.Single"
                        ColumnWidth="200px"
                        Density="Density.Default"
                        style="width: 100%; height: 93%"
                        FilterMode="FilterMode.Simple">
            <Columns>
                @*   <RadzenDataGridColumn TItem="GetProductWithPaginationDto" Property="Id" Title="Id" Filterable="false" Width="55px"/> *@


                <RadzenDataGridColumn TItem="GetProductWithPaginationDto" Property="CompanyName" Title="Şirket Adı" Filterable="true">
                    <FilterTemplate>
                        <RadzenDropDownDataGrid TValue="CompanyAllModel"
                                                class="custom-dropdown"
                                                Value=@selectedCompany
                                                Data=@companies?.data
                                                PageSize="18"
                                                AllowClear="true"
                                                Density="Density.Compact"
                                                FilterCaseSensitivity="FilterCaseSensitivity.CaseInsensitive"
                                                Change=@(args => OnDropDownValueChanged((CompanyAllModel)args))
                                                TextProperty="Name"
                                                SearchTextPlaceholder="Şirket ara"
                                                style="margin-right: 25px;" />
                    </FilterTemplate>
                </RadzenDataGridColumn>

                <RadzenDataGridColumn TItem="GetProductWithPaginationDto" Property="Name" Title="Ürün Adı" Filterable="true">
                    <FilterTemplate>
                        <RadzenTextBox type="search" @bind-Value="@filterValues[nameof(GetProductWithPaginationDto.Name)]" Change="@(args => ProductFiltering())" />
                    </FilterTemplate>
                </RadzenDataGridColumn>

                <RadzenDataGridColumn TItem="GetProductWithPaginationDto" Property="Barcode" Title="Barkod" Filterable="true">
                    <FilterTemplate>
                        <RadzenTextBox type="search" @bind-Value="@filterValues[nameof(GetProductWithPaginationDto.Barcode)]" Change="@(args => ProductFiltering())" />
                    </FilterTemplate>
                </RadzenDataGridColumn>

                <RadzenDataGridColumn TItem="GetProductWithPaginationDto" Property="Status" Title="Durum" Filterable="true">
                    <FilterTemplate>
                        <RadzenTextBox type="search" @bind-Value="@filterValues[nameof(GetProductWithPaginationDto.Status)]" Change="@(args => ProductFiltering())" />
                    </FilterTemplate>
                </RadzenDataGridColumn>

                <RadzenDataGridColumn TItem="GetProductWithPaginationDto" Property="ApprovalStatus" Title="Onay Durumu" Filterable="false" />

                <RadzenDataGridColumn TItem="GetProductWithPaginationDto" Property="AssignedUserId" Title="Zimmetlenen Kullanıcı Id" Filterable="false" Visible="false" />

                <RadzenDataGridColumn TItem="GetProductWithPaginationDto" Property="AssignedUserName" Title="Zimmetlenen Kullanıcı" Filterable="true">
                    <FilterTemplate>
                        <RadzenTextBox type="search" @bind-Value="@filterValues[nameof(GetProductWithPaginationDto.AssignedUserName)]" Change="@(args => ProductFiltering())" />
                    </FilterTemplate>
                </RadzenDataGridColumn>

                <RadzenDataGridColumn TItem="GetProductWithPaginationDto" Property="SerialNumber" Title="Seri No" Filterable="true">
                    <FilterTemplate>
                        <RadzenTextBox type="search" @bind-Value="@filterValues[nameof(GetProductWithPaginationDto.SerialNumber)]" Change="@(args => ProductFiltering())" />
                    </FilterTemplate>
                </RadzenDataGridColumn>

                <RadzenDataGridColumn TItem="GetProductWithPaginationDto" Property="Imei" Title="Imei" Filterable="true">
                    <FilterTemplate>
                        <RadzenTextBox type="search" @bind-Value="@filterValues[nameof(GetProductWithPaginationDto.Imei)]" Change="@(args => ProductFiltering())" />
                    </FilterTemplate>
                </RadzenDataGridColumn>

                <RadzenDataGridColumn TItem="GetProductWithPaginationDto" Property="Mac" Title="Mac" Filterable="true">
                    <FilterTemplate>
                        <RadzenTextBox type="search" @bind-Value="@filterValues[nameof(GetProductWithPaginationDto.Mac)]" Change="@(args => ProductFiltering())" />
                    </FilterTemplate>
                </RadzenDataGridColumn>

                <RadzenDataGridColumn TItem="GetProductWithPaginationDto" Property="CategoryId" Title="Kategori Id" Filterable="false" Visible="false" />
                <RadzenDataGridColumn TItem="GetProductWithPaginationDto" Property="CategoryName" Title="Kategori" Filterable="true" />
                <RadzenDataGridColumn TItem="GetProductWithPaginationDto" Property="CategorySubId" Title="Kategori Sub Id" Filterable="false" Visible="false" />
                <RadzenDataGridColumn TItem="GetProductWithPaginationDto" Property="CategorySubName" Title="Alt Kategori" Filterable="true" />
                <RadzenDataGridColumn TItem="GetProductWithPaginationDto" Property="BrandId" Title="Marka Id" Filterable="false" Visible="false" />
                <RadzenDataGridColumn TItem="GetProductWithPaginationDto" Property="BrandName" Title="Marka Adı" Filterable="true" />
                <RadzenDataGridColumn TItem="GetProductWithPaginationDto" Property="ModelId" Title="Model Id" Filterable="false" Visible="false" />
                <RadzenDataGridColumn TItem="GetProductWithPaginationDto" Property="ModelName" Title="Model Adı" Filterable="true" />
                <RadzenDataGridColumn TItem="GetProductWithPaginationDto" Property="PurchaseDate" Title="Satınalma Tarihi" Filterable="true" />

            </Columns>
        </RadzenDataGrid>

        <RadzenPager HorizontalAlign="HorizontalAlign.Center"
                     ShowPagingSummary="true"
                     PagingSummaryFormat="@pagingSummaryFormat"
                     Count="@productAndAssignedModel.totalCount"
                     PageSize="@productAndAssignedModel.pageSize"
                     PageNumbersCount="6"
                     PageChanged="@ChangePage"
                     PageSizeOptions="@pageSizeOptions"
                     PageSizeText="sayfa başına"
                     PageSizeChanged="@(args => PageSizeOptionsChanged(args))" />
    }
    else
    {
        <RadzenProgressBar ProgressBarStyle="ProgressBarStyle.Primary" Value="100" ShowValue="false" Mode="ProgressBarMode.Indeterminate" />
    }
}


